scenarios:
  # --- Phase 1.1: Basic File Opening ---
  - id: "smoke_minimal"
    generator: "basic_grid"
    args: { rows: 1, cols: 1 }
    output: "minimal.xlsx"

  # --- Phase 1.2: Is this a ZIP? ---
  - id: "container_random_zip"
    generator: "corrupt_container"
    args: { mode: "random_zip" }
    output: "random_zip.zip"
    
  - id: "container_no_content_types"
    generator: "corrupt_container"
    args: { mode: "no_content_types" }
    output: "no_content_types.xlsx"

  - id: "container_not_zip_text"
    generator: "corrupt_container"
    args: { mode: "not_zip_text" }
    output: "not_a_zip.txt"

  # --- PG1: Workbook -> Sheet -> Grid IR sanity ---
  - id: "pg1_basic_two_sheets"
    generator: "basic_grid"
    args: { rows: 3, cols: 3, two_sheets: true } # Sheet1 3x3, Sheet2 5x2 (logic in generator)
    output: "pg1_basic_two_sheets.xlsx"

  - id: "pg1_sparse"
    generator: "sparse_grid"
    output: "pg1_sparse_used_range.xlsx"

  - id: "pg1_mixed"
    generator: "edge_case"
    output: "pg1_empty_and_mixed_sheets.xlsx"

  # --- PG2: Addressing and index invariants ---
  - id: "pg2_addressing"
    generator: "address_sanity"
    args:
      targets: ["A1", "B2", "C3", "Z1", "Z10", "AA1", "AA10", "AB7", "AZ5", "BA1", "ZZ10", "AAA1"]
    output: "pg2_addressing_matrix.xlsx"

  # --- PG3: Cell snapshots and comparison semantics ---
  - id: "pg3_types"
    generator: "value_formula"
    output: "pg3_value_and_formula_cells.xlsx"

  # --- Phase 3: Spreadsheet-mode G1/G2 ---
  - id: "g1_equal_sheet"
    generator: "basic_grid"
    args:
      rows: 5
      cols: 5
      sheet: "Sheet1"
    output:
      - "equal_sheet_a.xlsx"
      - "equal_sheet_b.xlsx"

  - id: "g2_single_cell_value"
    generator: "single_cell_diff"
    args:
      rows: 5
      cols: 5
      sheet: "Sheet1"
      target_cell: "C3"
      value_a: 1.0
      value_b: 2.0
    output:
      - "single_cell_value_a.xlsx"
      - "single_cell_value_b.xlsx"

  # --- JSON diff: simple non-empty change ---
  - id: "json_diff_single_cell"
    generator: "single_cell_diff"
    args:
      rows: 3
      cols: 3
      sheet: "Sheet1"
      target_cell: "C3"
      value_a: "1"
      value_b: "2"
    output:
      - "json_diff_single_cell_a.xlsx"
      - "json_diff_single_cell_b.xlsx"

  - id: "json_diff_single_bool"
    generator: "single_cell_diff"
    args:
      rows: 3
      cols: 3
      sheet: "Sheet1"
      target_cell: "C3"
      value_a: true
      value_b: false
    output:
      - "json_diff_bool_a.xlsx"
      - "json_diff_bool_b.xlsx"

  - id: "json_diff_value_to_empty"
    generator: "single_cell_diff"
    args:
      rows: 3
      cols: 3
      sheet: "Sheet1"
      target_cell: "C3"
      value_a: "1"
      value_b: null
    output:
      - "json_diff_value_to_empty_a.xlsx"
      - "json_diff_value_to_empty_b.xlsx"

  # --- Sheet identity: case-only renames ---
  - id: "sheet_case_only_rename"
    generator: "sheet_case_rename"
    args:
      sheet_a: "Sheet1"
      sheet_b: "sheet1"
      cell: "A1"
      value_a: 1.0
      value_b: 1.0
    output:
      - "sheet_case_only_rename_a.xlsx"
      - "sheet_case_only_rename_b.xlsx"

  - id: "sheet_case_only_rename_cell_edit"
    generator: "sheet_case_rename"
    args:
      sheet_a: "Sheet1"
      sheet_b: "sheet1"
      cell: "A1"
      value_a: 1.0
      value_b: 2.0
    output:
      - "sheet_case_only_rename_edit_a.xlsx"
      - "sheet_case_only_rename_edit_b.xlsx"

  # --- PG6: Object graph vs grid responsibilities ---
  - id: "pg6_sheet_added"
    generator: "pg6_sheet_scenario"
    args:
      mode: "sheet_added"
    output:
      - "pg6_sheet_added_a.xlsx"
      - "pg6_sheet_added_b.xlsx"

  - id: "pg6_sheet_removed"
    generator: "pg6_sheet_scenario"
    args:
      mode: "sheet_removed"
    output:
      - "pg6_sheet_removed_a.xlsx"
      - "pg6_sheet_removed_b.xlsx"

  - id: "pg6_sheet_renamed"
    generator: "pg6_sheet_scenario"
    args:
      mode: "sheet_renamed"
    output:
      - "pg6_sheet_renamed_a.xlsx"
      - "pg6_sheet_renamed_b.xlsx"

  - id: "pg6_sheet_and_grid_change"
    generator: "pg6_sheet_scenario"
    args:
      mode: "sheet_and_grid_change"
    output:
      - "pg6_sheet_and_grid_change_a.xlsx"
      - "pg6_sheet_and_grid_change_b.xlsx"

  # --- Milestone 2.2: Base64 Correctness ---
  - id: "corrupt_base64"
    generator: "mashup_corrupt"
    args: 
      base_file: "templates/base_query.xlsx"
      mode: "byte_flip"
    output: "corrupt_base64.xlsx"

  - id: "duplicate_datamashup_parts"
    generator: "mashup_duplicate"
    args:
      base_file: "templates/base_query.xlsx"
    output: "duplicate_datamashup_parts.xlsx"

  - id: "duplicate_datamashup_elements"
    generator: "mashup_duplicate"
    args:
      base_file: "templates/base_query.xlsx"
      mode: "element"
    output: "duplicate_datamashup_elements.xlsx"

  - id: "mashup_utf16_le"
    generator: "mashup_encode"
    args:
      base_file: "templates/base_query.xlsx"
      encoding: "utf-16-le"
    output: "mashup_utf16_le.xlsx"

  - id: "mashup_utf16_be"
    generator: "mashup_encode"
    args:
      base_file: "templates/base_query.xlsx"
      encoding: "utf-16-be"
    output: "mashup_utf16_be.xlsx"

  - id: "mashup_base64_whitespace"
    generator: "mashup_encode"
    args:
      base_file: "templates/base_query.xlsx"
      whitespace: true
    output: "mashup_base64_whitespace.xlsx"

  # --- Milestone 4.1: PackageParts ---
  - id: "m4_packageparts_one_query"
    generator: "mashup:one_query"
    args:
      base_file: "templates/base_query.xlsx"
    output: "one_query.xlsx"

  - id: "m4_packageparts_multi_embedded"
    generator: "mashup:multi_query_with_embedded"
    args:
      base_file: "templates/base_query.xlsx"
    output: "multi_query_with_embedded.xlsx"

  # --- Milestone 4.2-4.4: Permissions / Metadata ---
  - id: "permissions_defaults"
    generator: "mashup:permissions_metadata"
    args:
      mode: "permissions_defaults"
      base_file: "templates/base_query.xlsx"
    output: "permissions_defaults.xlsx"

  - id: "permissions_firewall_off"
    generator: "mashup:permissions_metadata"
    args:
      mode: "permissions_firewall_off"
      base_file: "templates/base_query.xlsx"
    output: "permissions_firewall_off.xlsx"

  - id: "metadata_simple"
    generator: "mashup:permissions_metadata"
    args:
      mode: "metadata_simple"
      base_file: "templates/base_query.xlsx"
    output: "metadata_simple.xlsx"

  - id: "metadata_query_groups"
    generator: "mashup:permissions_metadata"
    args:
      mode: "metadata_query_groups"
      base_file: "templates/base_query.xlsx"
    output: "metadata_query_groups.xlsx"

  - id: "metadata_hidden_queries"
    generator: "mashup:permissions_metadata"
    args:
      mode: "metadata_hidden_queries"
      base_file: "templates/base_query.xlsx"
    output: "metadata_hidden_queries.xlsx"

  - id: "metadata_missing_entry"
    generator: "mashup:permissions_metadata"
    args:
      mode: "metadata_missing_entry"
      base_file: "templates/base_query.xlsx"
    output: "metadata_missing_entry.xlsx"

  - id: "metadata_url_encoding"
    generator: "mashup:permissions_metadata"
    args:
      mode: "metadata_url_encoding"
      base_file: "templates/base_query.xlsx"
    output: "metadata_url_encoding.xlsx"

  - id: "metadata_orphan_entries"
    generator: "mashup:permissions_metadata"
    args:
      mode: "metadata_orphan_entries"
      base_file: "templates/base_query.xlsx"
    output: "metadata_orphan_entries.xlsx"

  # --- Milestone 6: Basic M Diffs ---
  - id: "m_add_query_a"
    generator: "mashup:permissions_metadata"
    args:
      mode: "m_add_query_a"
      base_file: "templates/base_query.xlsx"
    output: "m_add_query_a.xlsx"

  - id: "m_add_query_b"
    generator: "mashup:permissions_metadata"
    args:
      mode: "m_add_query_b"
      base_file: "templates/base_query.xlsx"
    output: "m_add_query_b.xlsx"

  - id: "m_remove_query_a"
    generator: "mashup:permissions_metadata"
    args:
      mode: "m_remove_query_a"
      base_file: "templates/base_query.xlsx"
    output: "m_remove_query_a.xlsx"

  - id: "m_remove_query_b"
    generator: "mashup:permissions_metadata"
    args:
      mode: "m_remove_query_b"
      base_file: "templates/base_query.xlsx"
    output: "m_remove_query_b.xlsx"

  - id: "m_change_literal_a"
    generator: "mashup:permissions_metadata"
    args:
      mode: "m_change_literal_a"
      base_file: "templates/base_query.xlsx"
    output: "m_change_literal_a.xlsx"

  - id: "m_change_literal_b"
    generator: "mashup:permissions_metadata"
    args:
      mode: "m_change_literal_b"
      base_file: "templates/base_query.xlsx"
    output: "m_change_literal_b.xlsx"

  - id: "m_metadata_only_change_a"
    generator: "mashup:permissions_metadata"
    args:
      mode: "m_metadata_only_change_a"
      base_file: "templates/base_query.xlsx"
    output: "m_metadata_only_change_a.xlsx"

  - id: "m_metadata_only_change_b"
    generator: "mashup:permissions_metadata"
    args:
      mode: "m_metadata_only_change_b"
      base_file: "templates/base_query.xlsx"
    output: "m_metadata_only_change_b.xlsx"

  - id: "m_def_and_metadata_change_a"
    generator: "mashup:permissions_metadata"
    args:
      mode: "m_def_and_metadata_change_a"
      base_file: "templates/base_query.xlsx"
    output: "m_def_and_metadata_change_a.xlsx"

  - id: "m_def_and_metadata_change_b"
    generator: "mashup:permissions_metadata"
    args:
      mode: "m_def_and_metadata_change_b"
      base_file: "templates/base_query.xlsx"
    output: "m_def_and_metadata_change_b.xlsx"

  - id: "m_rename_query_a"
    generator: "mashup:permissions_metadata"
    args:
      mode: "m_rename_query_a"
      base_file: "templates/base_query.xlsx"
    output: "m_rename_query_a.xlsx"

  - id: "m_rename_query_b"
    generator: "mashup:permissions_metadata"
    args:
      mode: "m_rename_query_b"
      base_file: "templates/base_query.xlsx"
    output: "m_rename_query_b.xlsx"

  # --- P1: Large Dense Grid (Performance Baseline) ---
  - id: "p1_large_dense"
    generator: "perf_large"
    args: 
      rows: 50000 
      cols: 20
      mode: "dense" # Deterministic "R1C1" style data
    output: "grid_large_dense.xlsx"

  # --- P2: Large Noise Grid (Worst-case Alignment) ---
  - id: "p2_large_noise"
    generator: "perf_large"
    args: 
      rows: 50000 
      cols: 20
      mode: "noise" # Random float data
      seed: 12345
    output: "grid_large_noise.xlsx"

  # --- D1: Keyed Equality (Database Mode) ---
  # File A: Ordered IDs 1..1000
  - id: "db_equal_ordered_a"
    generator: "db_keyed"
    args: { count: 1000, shuffle: false, seed: 42 }
    output: "db_equal_ordered_a.xlsx"

  # File B: Same data, random order (Tests O(N) alignment)
  - id: "db_equal_ordered_b"
    generator: "db_keyed"
    args: { count: 1000, shuffle: true, seed: 42 }
    output: "db_equal_ordered_b.xlsx"

  # --- D2: Row Added (Database Mode) ---
  - id: "db_row_added_b"
    generator: "db_keyed"
    args: 
      count: 1000 
      seed: 42 
      # Inject a new ID at the end
      extra_rows: [{id: 1001, name: "New Row", amount: 999}]
    output: "db_row_added_b.xlsx"
