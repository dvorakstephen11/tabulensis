scenarios:
  - id: "pg1_basic_two_sheets"
    generator: "basic_grid"
    args: { rows: 3, cols: 3, two_sheets: true }
    output: "pg1_basic_two_sheets.xlsx"

  - id: "m4_packageparts_one_query"
    generator: "mashup:one_query"
    args:
      base_file: "templates/base_query.xlsx"
    output: "one_query.xlsx"

  - id: "g1_equal_sheet"
    generator: "basic_grid"
    args:
      rows: 5
      cols: 5
      sheet: "Sheet1"
    output:
      - "equal_sheet_a.xlsx"
      - "equal_sheet_b.xlsx"

  - id: "g2_single_cell_value"
    generator: "single_cell_diff"
    args:
      rows: 5
      cols: 5
      sheet: "Sheet1"
      target_cell: "C3"
      value_a: 1.0
      value_b: 2.0
    output:
      - "single_cell_value_a.xlsx"
      - "single_cell_value_b.xlsx"

  - id: "g8_row_insert_middle"
    generator: "row_alignment_g8"
    args:
      mode: "insert"
      sheet: "Sheet1"
      base_rows: 10
      cols: 5
      insert_at: 6
    output:
      - "row_insert_middle_a.xlsx"
      - "row_insert_middle_b.xlsx"

  - id: "g9_col_insert_middle"
    generator: "column_alignment_g9"
    args:
      mode: "insert"
      sheet: "Data"
      cols: 8
      data_rows: 9
      insert_at: 4
    output:
      - "col_insert_middle_a.xlsx"
      - "col_insert_middle_b.xlsx"

  - id: "m_add_query_a"
    generator: "mashup:permissions_metadata"
    args:
      mode: "m_add_query_a"
      base_file: "templates/base_query.xlsx"
    output: "m_add_query_a.xlsx"

  - id: "m_add_query_b"
    generator: "mashup:permissions_metadata"
    args:
      mode: "m_add_query_b"
      base_file: "templates/base_query.xlsx"
    output: "m_add_query_b.xlsx"

  - id: "m_change_literal_a"
    generator: "mashup:permissions_metadata"
    args:
      mode: "m_change_literal_a"
      base_file: "templates/base_query.xlsx"
    output: "m_change_literal_a.xlsx"

  - id: "m_change_literal_b"
    generator: "mashup:permissions_metadata"
    args:
      mode: "m_change_literal_b"
      base_file: "templates/base_query.xlsx"
    output: "m_change_literal_b.xlsx"

  - id: "m_embedded_change_a"
    generator: "mashup:multi_query_with_embedded"
    args:
      base_file: "templates/base_query.xlsx"
      embedded_guid: "efgh"
      embedded_section: |
        section Section1;
        shared Inner = let
          Source = 1
        in
          Source;
    output: "m_embedded_change_a.xlsx"

  - id: "m_embedded_change_b"
    generator: "mashup:multi_query_with_embedded"
    args:
      base_file: "templates/base_query.xlsx"
      embedded_guid: "efgh"
      embedded_section: |
        section Section1;
        shared Inner = let
          Source = 2
        in
          Source;
    output: "m_embedded_change_b.xlsx"

  - id: "branch4_named_ranges"
    generator: "named_ranges"
    output:
      - "named_ranges_a.xlsx"
      - "named_ranges_b.xlsx"

  - id: "branch4_charts"
    generator: "charts"
    output:
      - "charts_a.xlsx"
      - "charts_b.xlsx"

  - id: "branch4_vba_base"
    generator: "copy_template"
    args:
      template: "templates/vba_base.xlsm"
    output: "vba_base.xlsm"

  - id: "branch4_vba_added"
    generator: "copy_template"
    args:
      template: "templates/vba_added.xlsm"
    output: "vba_added.xlsm"

  - id: "branch4_vba_changed"
    generator: "copy_template"
    args:
      template: "templates/vba_changed.xlsm"
    output: "vba_changed.xlsm"

  - id: "branch1_pbix_legacy_one_query_a"
    generator: "pbix"
    args:
      mode: "from_xlsx"
      base_file: "generated/m_change_literal_a.xlsx"
    output: "pbix_legacy_one_query_a.pbix"

  - id: "branch1_pbix_legacy_one_query_b"
    generator: "pbix"
    args:
      mode: "from_xlsx"
      base_file: "generated/m_change_literal_b.xlsx"
    output: "pbix_legacy_one_query_b.pbix"

  - id: "branch1_pbix_legacy_multi_query_a"
    generator: "pbix"
    args:
      mode: "from_xlsx"
      base_file: "generated/m_add_query_a.xlsx"
    output: "pbix_legacy_multi_query_a.pbix"

  - id: "branch1_pbix_legacy_multi_query_b"
    generator: "pbix"
    args:
      mode: "from_xlsx"
      base_file: "generated/m_add_query_b.xlsx"
    output: "pbix_legacy_multi_query_b.pbix"

  - id: "branch1_pbix_no_datamashup"
    generator: "pbix"
    args:
      mode: "no_datamashup"
    output: "pbix_no_datamashup.pbix"

  - id: "branch1_pbix_no_datamashup_no_schema"
    generator: "pbix"
    args:
      mode: "no_schema"
    output: "pbix_no_datamashup_no_schema.pbix"

  - id: "branch1_pbit_model_a"
    generator: "pbix"
    args:
      mode: "no_datamashup"
      model_schema: |
        {
          "model": {
            "tables": [
              {
                "name": "Sales",
                "measures": [
                  { "name": "Total Sales", "expression": "SUM(Sales[Amount])" }
                ]
              }
            ]
          }
        }
    output: "pbit_model_a.pbit"

  - id: "branch1_pbit_model_b"
    generator: "pbix"
    args:
      mode: "no_datamashup"
      model_schema: |
        {
          "model": {
            "tables": [
              {
                "name": "Sales",
                "measures": [
                  { "name": "Total Sales", "expression": "SUMX(Sales, Sales[Amount])" },
                  { "name": "Net Sales", "expression": "SUM(Sales[Net])" }
                ]
              }
            ]
          }
        }
    output: "pbit_model_b.pbit"

  - id: "branch2_pbix_embedded_queries"
    generator: "pbix"
    args:
      mode: "from_xlsx"
      base_file: "generated/m_embedded_change_a.xlsx"
    output: "pbix_embedded_queries.pbix"

