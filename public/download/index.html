<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Download | Tabulensis</title>
    <meta name="description" content="Download Tabulensis CLI binaries or install from source.">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;600&family=Space+Grotesk:wght@400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../styles.css">
  </head>
  <body>
    <div class="shell">
      <header>
        <a class="brand" href="/">Tabulensis</a>
        <nav>
          <a href="/download">Download</a>
          <a href="/docs">Docs</a>
          <a href="/support">Support</a>
          <a href="/privacy">Privacy</a>
          <a href="/terms">Terms</a>
          <a href="/eula">EULA</a>
        </nav>
      </header>

      <h1 class="page-title">Download &amp; Activate</h1>
      <p class="page-body">
        Start a trial, receive a license key, then download the CLI or desktop app.
        Everything runs locally and your workbooks stay on your machine.
      </p>

      <div class="checkout-row">
        <input id="checkout-email" class="input" type="email" inputmode="email" autocomplete="email" autocapitalize="none" spellcheck="false" required placeholder="Email for license delivery">
        <button id="checkout-btn" class="cta primary" data-checkout-url="https://license.tabulensis.com/api/checkout/start">Start trial / Buy</button>
        <a class="cta" href="/docs">Docs</a>
      </div>
      <div id="checkout-status" class="note" style="display:none;"></div>
      <div class="card-grid">
        <div class="card">
          <h3>Windows</h3>
          <p>Download the latest Windows ZIP (recommended) or standalone EXE from GitHub Releases.</p>
          <div class="page-links">
            <a href="https://github.com/dvora/excel_diff/releases/latest/download/tabulensis-latest-windows-x86_64.zip">Windows ZIP</a>
            <a href="https://github.com/dvora/excel_diff/releases/latest/download/tabulensis-latest-windows-x86_64.exe">Standalone EXE</a>
          </div>
        </div>
        <div class="card">
          <h3>macOS</h3>
          <p>Universal macOS binaries are available with each release.</p>
          <div class="page-links">
            <a href="https://github.com/dvora/excel_diff/releases/latest/download/tabulensis-latest-macos-universal.tar.gz">macOS universal</a>
          </div>
        </div>
        <div class="card">
          <h3>Linux</h3>
          <p>Download the latest Linux tar.gz from GitHub Releases.</p>
          <div class="page-links">
            <a href="https://github.com/dvora/excel_diff/releases/latest/download/tabulensis-latest-linux-x86_64.tar.gz">Linux x86_64 tar.gz</a>
          </div>
        </div>
      </div>

      <div class="section">
        <div>
          <h2>Activation steps</h2>
          <p>After checkout, you will receive a license key. Activate it before running diffs.</p>
        </div>
        <div class="card">
          <h3>CLI activation</h3>
          <div class="note">tabulensis license activate &lt;KEY&gt;</div>
          <p>Check status with <code>tabulensis license status</code>.</p>
        </div>
      </div>

      <div class="section">
        <div>
          <h2>From source</h2>
          <p>Install the CLI directly from the repo when you want the freshest build.</p>
        </div>
        <div class="card">
          <div class="note">cargo install --locked --path cli</div>
          <p>Use the <code>excel_diff</code> crate if you are embedding diffs.</p>
        </div>
      </div>
      <p class="page-body">
        By downloading or using Tabulensis, you agree to the <a href="/terms">Terms</a> and
        <a href="/eula">EULA</a>.
      </p>
      <div class="page-links">
        <a href="/download/success">Post-checkout help</a>
        <a href="/support/resend">Resend license</a>
        <a href="/support/billing">Cancel or update billing</a>
      </div>

      <footer>
        <div>Shipping diffs without the noise.</div>
        <div class="footer-meta">
          <div>Tabulensis is a product of Positive Sum Technologies LLC.</div>
          <div>&copy; 2026 Positive Sum Technologies LLC</div>
          <div>Contact: <a href="mailto:support@tabulensis.com">support@tabulensis.com</a></div>
        </div>
      </footer>
    </div>
    <script type="module">
      const btn = document.getElementById("checkout-btn");
      const status = document.getElementById("checkout-status");
      const emailInput = document.getElementById("checkout-email");

      function showStatus(message) {
        if (!status) return;
        status.style.display = "block";
        status.textContent = String(message || "");
      }

      function clearStatus() {
        if (!status) return;
        status.style.display = "none";
        status.textContent = "";
      }

      function emailValue() {
        return String(emailInput?.value || "").trim();
      }

      function setCheckoutEnabled() {
        if (!btn) return;
        const emailOk = emailInput && emailValue() && emailInput.validity.valid;
        btn.disabled = !emailOk;
      }

      async function startCheckout() {
        if (!btn || !emailInput) return;
        const email = emailValue();
        if (!email || !emailInput.validity.valid) {
          showStatus("Enter a valid email address for license delivery.");
          emailInput.focus();
          setCheckoutEnabled();
          return;
        }

        btn.disabled = true;
        btn.textContent = "Starting checkout...";
        clearStatus();
        try {
          const checkoutUrl =
            btn.dataset.checkoutUrl || "https://license.tabulensis.com/api/checkout/start";
          const res = await fetch(checkoutUrl, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ email }),
          });
          const data = await res.json();
          if (!res.ok) {
            throw new Error(data?.error || "Checkout failed");
          }
          if (data.checkout_url) {
            window.location.href = data.checkout_url;
            return;
          }
          throw new Error("Missing checkout URL");
        } catch (err) {
          showStatus(err);
        } finally {
          setCheckoutEnabled();
          btn.textContent = "Start trial / Buy";
        }
      }

      if (btn) {
        btn.addEventListener("click", startCheckout);
      }
      if (emailInput) {
        emailInput.addEventListener("input", () => {
          clearStatus();
          setCheckoutEnabled();
        });
      }
      setCheckoutEnabled();
    </script>
  </body>
</html>
