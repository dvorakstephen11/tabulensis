   Compiling excel_diff v0.1.0 (C:\Users\dvora\repo\excel_diff\core)
    Finished `test` profile [unoptimized + debuginfo] target(s) in 8.11s
     Running unittests src\lib.rs (target\debug\deps\excel_diff-269e5b0d30f4d8cf.exe)

running 143 tests
test addressing::tests::round_trip_addresses ... ok
test addressing::tests::index_to_address_examples ... ok
test addressing::tests::invalid_addresses_rejected ... ok
test alignment::anchor_chain::tests::builds_increasing_chain ... ok
test alignment::assembly::tests::amr_alignment_empty_grids ... ok
test alignment::assembly::tests::amr_alignment_all_inserted ... ok
test alignment::assembly::tests::amr_alignment_all_deleted ... ok
test alignment::anchor_discovery::tests::discovers_context_anchors_when_no_uniques ... ok
test alignment::assembly::tests::hash_fallback_produces_monotone_pairs ... ok
test alignment::assembly::tests::amr_multi_gap_move_detection_produces_expected_row_block_move ... ok
test alignment::assembly::tests::amr_disjoint_gaps_with_insertions_and_deletions ... ok
test alignment::assembly::tests::amr_recursive_gap_alignment_returns_monotonic_alignment ... ok
test alignment::assembly::tests::align_rows_amr_with_signatures_exposes_row_hashes ... ok
test alignment::gap_strategy::tests::respects_configured_max_lcs_gap_size ... ok
test alignment::row_metadata::tests::classifies_unique_and_rare_and_low_info ... ok
test alignment::assembly::tests::myers_handles_medium_gap_with_single_insertion ... ok
test alignment::assembly::tests::run_alignment_falls_back_on_mismatch ... ok
test alignment::runs::tests::compresses_identical_rows ... ok
test alignment::runs::tests::empty_input_produces_empty_runs ... ok
test alignment::runs::tests::mixed_runs_with_varying_lengths ... ok
test alignment::runs::tests::run_compression_preserves_row_indices ... ok
test alignment::runs::tests::single_row_produces_single_run ... ok
test alignment::assembly::tests::aligns_compressed_runs_with_insert_and_delete ... ok
test alignment::runs::tests::compresses_10k_identical_rows_to_single_run ... ok
test column_alignment::tests::detect_exact_column_block_move_rejects_repetition ... ok
test column_alignment::tests::detect_exact_column_block_move_rejects_internal_edits ... ok
test column_alignment::tests::detect_exact_column_block_move_multi_column_block ... ok
test column_alignment::tests::detect_exact_column_block_move_simple_case ... ok
test column_alignment::tests::detect_exact_column_block_move_rejects_two_independent_moves ... ok
test column_alignment::tests::detect_exact_column_block_move_swap_as_single_move ... ok
test config::tests::defaults_match_limit_spec ... ok
test column_alignment::tests::single_insert_aligns_all_columns ... ok
test config::tests::builder_rejects_invalid_similarity_threshold ... ok
test column_alignment::tests::multiple_unique_columns_causes_bailout ... ok
test config::tests::presets_differ_in_expected_directions ... ok
test column_alignment::tests::heavy_repetition_causes_bailout ... ok
test alignment::runs::tests::alternating_pattern_ab_does_not_overcompress ... ok
test config::tests::serde_aliases_populate_fields ... ok
test database_alignment::tests::composite_key_alignment_matches_rows_correctly ... ok
test database_alignment::tests::duplicate_keys_error_or_unsupported ... ok
test config::tests::serde_roundtrip_preserves_defaults ... ok
test database_alignment::tests::is_key_column_contiguous_columns ... ok
test database_alignment::tests::is_key_column_non_contiguous_columns ... ok
test database_alignment::tests::is_key_column_non_contiguous_three_columns ... ok
test database_alignment::tests::is_key_column_single_column ... ok
test database_alignment::tests::is_key_column_three_columns ... ok
test database_alignment::tests::non_contiguous_key_columns_alignment ... ok
test database_alignment::tests::unique_keys_insert_delete_classified ... ok
test database_alignment::tests::unique_keys_reorder_no_changes ... ok
test datamashup_framing::tests::decode_datamashup_base64_rejects_invalid ... ok
test alignment::assembly::tests::align_small_gap_enforces_cap_with_hash_fallback ... ok
test database_alignment::tests::three_column_composite_key_alignment ... ok
test datamashup_framing::tests::elements_with_datamashup_suffix_are_ignored ... ok
test datamashup_framing::tests::duplicate_sibling_datamashup_elements_error ... ok
test datamashup_framing::tests::fuzz_style_never_panics ... ok
test datamashup_framing::tests::parse_basic_non_zero_lengths ... ok
test datamashup_framing::tests::parse_zero_length_stream_succeeds ... ok
test datamashup_framing::tests::too_short_stream_is_framing_invalid ... ok
test datamashup_framing::tests::trailing_bytes_are_invalid ... ok
test datamashup_framing::tests::truncated_stream_errors ... ok
test datamashup_framing::tests::unsupported_version_is_rejected ... ok
test datamashup_framing::tests::utf16_datamashup_xml_decodes_correctly ... ok
test engine::tests::diff_row_pair_sparse_counts_union_for_sparse_columns ... ok
test datamashup_framing::tests::utf16_without_bom_with_declared_encoding_parses ... ok
test engine::tests::diff_row_pair_sparse_counts_union_columns_not_sum_lengths ... ok
test engine::tests::grids_non_blank_cells_equal_requires_matching_entries ... ok
test engine::tests::sheet_kind_order_ranking_includes_macro_and_other ... ok
test grid_parser::tests::convert_value_bool_0_1_and_other ... ok
test grid_parser::tests::convert_value_error_cell_as_text ... ok
test grid_parser::tests::convert_value_shared_string_index_out_of_bounds_errors ... ok
test grid_parser::tests::parse_shared_strings_rich_text_flattens_runs ... ok
test grid_parser::tests::read_inline_string_preserves_xml_space_preserve ... ok
test hashing::tests::normalize_distinguishes_different_magnitudes ... ok
test hashing::tests::normalize_meaningful_difference ... ok
test hashing::tests::normalize_nan_values ... ok
test hashing::tests::normalize_preserves_large_numbers ... ok
test hashing::tests::normalize_ulp_drift ... ok
test hashing::tests::normalize_zero_values ... ok
test rect_block_move::tests::detect_bails_on_empty_grid ... ok
test rect_block_move::tests::detect_bails_on_different_grid_dimensions ... ok
test rect_block_move::tests::detect_bails_on_ambiguous_block_swap ... ok
test rect_block_move::tests::detect_bails_on_identical_grids ... ok
test rect_block_move::tests::detect_bails_on_oversized_col_count ... ok
test rect_block_move::tests::detect_bails_on_oversized_row_count ... ok
test rect_block_move::tests::detect_bails_on_pure_row_move_pattern ... ok
test rect_block_move::tests::detect_bails_on_single_cell_edit ... ok
test region_mask::tests::active_rows_iterator ... ok
test region_mask::tests::all_active_initially ... ok
test rect_block_move::tests::detect_bails_on_non_contiguous_differences ... ok
test region_mask::tests::cell_active_based_on_row_and_col ... ok
test rect_block_move::tests::detect_bails_on_internal_cell_edit ... ok
test region_mask::tests::cols_overlap_excluded_detects_overlap ... ok
test region_mask::tests::exclude_rect ... ok
test region_mask::tests::exclude_rect_cells_masks_only_that_region ... ok
test region_mask::tests::exclude_row_range ... ok
test rect_block_move::tests::detect_rect_block_move_with_shared_columns ... ok
test region_mask::tests::exclude_single_row ... ok
test region_mask::tests::rect_overlaps_excluded_detects_any_overlap ... ok
test region_mask::tests::rows_overlap_excluded_detects_overlap ... ok
test rect_block_move::tests::detect_simple_rect_block_move_success ... ok
test row_alignment::tests::align_row_changes_rejects_column_delete_mismatch ... ok
test row_alignment::tests::align_row_changes_rejects_column_insert_mismatch ... ok
test row_alignment::tests::aligns_delete_at_last_row ... ok
test row_alignment::tests::aligns_contiguous_block_delete_middle ... ok
test row_alignment::tests::aligns_delete_at_row_zero ... ok
test row_alignment::tests::aligns_insert_at_last_row ... ok
test row_alignment::tests::aligns_contiguous_block_insert_middle ... ok
test row_alignment::tests::aligns_insert_at_row_zero ... ok
test row_alignment::tests::aligns_single_row_to_two_rows_via_insert ... ok
test row_alignment::tests::aligns_two_rows_to_single_row_via_delete ... ok
test row_alignment::tests::aligns_single_insert_with_unique_row ... ok
test row_alignment::tests::block_move_detection_rejects_internal_edits ... ok
test row_alignment::tests::block_alignment_bails_on_noncontiguous_changes ... ok
test row_alignment::tests::detects_exact_row_block_move ... ok
test row_alignment::tests::monotonicity_helper_accepts_empty_and_single ... ok
test row_alignment::tests::fuzzy_move_bails_on_heavy_repetition_or_ambiguous_candidates ... ok
test row_alignment::tests::fuzzy_move_noop_when_grids_identical ... ok
test row_alignment::tests::monotonicity_helper_accepts_valid_sequence ... ok
test row_alignment::tests::monotonicity_helper_rejects_non_increasing_a ... ok
test row_alignment::tests::detects_fuzzy_row_block_move_upward_with_single_internal_edit ... ok
test row_alignment::tests::monotonicity_helper_rejects_non_increasing_b ... ok
test row_alignment::tests::detects_fuzzy_row_block_move_with_single_internal_edit ... ok
test row_alignment::tests::fuzzy_move_bails_on_ambiguous_candidates_below_repetition_threshold ... ok
test row_alignment::tests::rejects_non_monotonic_alignment_with_extra_mismatch ... ok
test workbook::tests::cellvalue_as_text_number_bool_match_variants ... ok
test row_alignment::tests::fuzzy_move_rejects_low_similarity_block ... ok
test row_alignment::tests::fuzzy_move_at_max_hash_repeat_boundary ... ok
test workbook::tests::cellvalue_number_hashes_ignore_ulp_drift ... ok
test workbook::tests::cellvalue_number_hashes_meaningful_difference ... ok
test workbook::tests::cellvalue_number_hashes_normalize_zero_sign ... ok
test workbook::tests::compute_col_signature_matches_cached_for_dense_and_sparse_paths ... ok
test workbook::tests::compute_row_signature_matches_cached_for_dense_and_sparse_paths ... ok
test workbook::tests::get_mut_clears_cached_signatures ... ok
test workbook::tests::insert_clears_cached_signatures ... ok
test workbook::tests::snapshot_equality_ignores_address ... ok
test workbook::tests::snapshot_equality_same_value_and_formula ... ok
test workbook::tests::snapshot_from_bool_cell ... ok
test workbook::tests::snapshot_from_empty_cell ... ok
test workbook::tests::snapshot_from_number_cell ... ok
test workbook::tests::snapshot_from_text_cell ... ok
test workbook::tests::snapshot_inequality_different_value_same_formula ... ok
test row_alignment::tests::fuzzy_move_at_max_block_rows_threshold ... ok
test workbook::tests::snapshot_inequality_value_vs_formula ... ok

test result: ok. 143 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.01s

     Running tests\addressing_pg2_tests.rs (target\debug\deps\addressing_pg2_tests-935963ebf0aeff35.exe)

running 1 test
test pg2_addressing_matrix_consistency ... ok

test result: ok. 1 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.00s

     Running tests\amr_multi_gap_tests.rs (target\debug\deps\amr_multi_gap_tests-34666f8c8dd236b7.exe)

running 5 tests
test amr_multiple_anchors_with_gaps ... ok
test amr_two_disjoint_insertion_regions ... ok
test amr_insertion_and_deletion_in_different_regions ... ok
test amr_gap_contains_moved_block_scenario ... ok
test amr_recursive_gap_alignment ... ok

test result: ok. 5 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.00s

     Running tests\d1_database_mode_tests.rs (target\debug\deps\d1_database_mode_tests-d72728cc98c7cfb7.exe)

running 19 tests
test d5_composite_key_partial_key_mismatch_yields_add_and_remove ... ok
test d1_database_mode_detects_meaningful_float_key_change ... ok
test d1_database_mode_cell_edited ... ok
test d1_database_mode_row_removed ... ok
test d1_database_mode_treats_small_float_key_noise_as_equal ... ok
test d1_database_mode_cell_edited_with_reorder ... ok
test d5_composite_key_equal_reordered_database_mode_empty_diff ... ok
test d1_database_mode_row_added ... ok
test d5_non_contiguous_key_columns_detects_edits_in_skipped_column ... ok
test d1_duplicate_keys_fallback_to_spreadsheet_mode ... ok
test d5_composite_key_row_added_and_cell_edited ... ok
test d5_non_contiguous_key_columns_equal_reordered_empty_diff ... ok
test d5_composite_key_duplicate_keys_fallback_to_spreadsheet_mode ... ok
test d5_non_contiguous_key_columns_row_added_and_cell_edited ... ok
test d5_three_column_composite_key_partial_match_yields_add_and_remove ... ok
test d5_three_column_composite_key_equal_reordered_empty_diff ... ok
test d1_equal_ordered_database_mode_empty_diff ... ok
test d1_equal_reordered_database_mode_empty_diff ... ok
test d1_spreadsheet_mode_sees_reorder_as_changes ... ok

test result: ok. 19 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.23s

     Running tests\data_mashup_tests.rs (target\debug\deps\data_mashup_tests-216909e21f08279c.exe)

running 13 tests
test non_excel_container_returns_not_excel_error ... ok
test non_zip_file_returns_not_zip_error ... ok
test nonexistent_file_returns_io ... ok
test missing_content_types_is_not_excel_error ... ok
test workbook_without_datamashup_returns_none ... ok
test duplicate_datamashup_elements_are_rejected ... ok
test corrupt_base64_returns_error ... ok
test datamashup_with_base64_whitespace_parses ... ok
test utf16_le_datamashup_parses ... ok
test utf16_be_datamashup_parses ... ok
test build_data_mashup_smoke_from_fixture ... ok
test workbook_with_valid_datamashup_parses ... ok
test duplicate_datamashup_parts_are_rejected ... ok

test result: ok. 13 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.01s

     Running tests\engine_tests.rs (target\debug\deps\engine_tests-3038e5d60d61b811.exe)

running 12 tests
test sheet_identity_includes_kind ... ok
test sheet_identity_includes_kind_for_macro_and_other ... ok
test duplicate_sheet_identity_panics_in_debug ... ok
test sheet_name_case_insensitive_cell_edit ... ok
test cell_edited_detected ... ok
test deterministic_sheet_op_ordering ... ok
test sheet_added_detected ... ok
test sheet_name_case_insensitive_no_changes ... ok
test identical_workbooks_produce_empty_report ... ok
test diff_report_json_round_trips ... ok
test sheet_removed_detected ... ok
test move_detection_respects_column_gate ... ok

test result: ok. 12 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.04s

     Running tests\excel_open_xml_tests.rs (target\debug\deps\excel_open_xml_tests-1fbde3a7c111800d.exe)

running 7 tests
test open_nonexistent_file_returns_io_error ... ok
test random_zip_is_not_excel ... ok
test no_content_types_is_not_excel ... ok
test open_minimal_workbook_succeeds ... ok
test not_zip_container_returns_error ... ok
test missing_workbook_xml_returns_workbookxmlmissing ... ok
test missing_worksheet_xml_returns_worksheetxmlmissing ... ok

test result: ok. 7 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.00s

     Running tests\g10_row_block_alignment_grid_workbook_tests.rs (target\debug\deps\g10_row_block_alignment_grid_workbook_tests-dd0b72c0b9debfcc.exe)

running 2 tests
test g10_row_block_delete_middle_emits_four_rowremoved_and_no_noise ... ok
test g10_row_block_insert_middle_emits_four_rowadded_and_no_noise ... ok

test result: ok. 2 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.01s

     Running tests\g11_row_block_move_grid_workbook_tests.rs (target\debug\deps\g11_row_block_move_grid_workbook_tests-2c4b4903ef0c3d7f.exe)

running 2 tests
test g11_repeated_rows_do_not_emit_blockmove ... ok
test g11_row_block_move_emits_single_blockmovedrows ... ok

test result: ok. 2 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.01s

     Running tests\g12_column_block_move_grid_workbook_tests.rs (target\debug\deps\g12_column_block_move_grid_workbook_tests-321e47120c66e117.exe)

running 5 tests
test g12_repeated_columns_do_not_emit_blockmovedcolumns ... ok
test g12_two_independent_column_moves_do_not_emit_blockmovedcolumns ... ok
test g12_column_swap_emits_blockmovedcolumns ... ok
test g12_multi_column_block_move_emits_blockmovedcolumns ... ok
test g12_column_move_emits_single_blockmovedcolumns ... ok

test result: ok. 5 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.01s

     Running tests\g12_rect_block_move_grid_workbook_tests.rs (target\debug\deps\g12_rect_block_move_grid_workbook_tests-07f32b088aa144ff.exe)

running 3 tests
test g12_rect_block_move_ambiguous_swap_does_not_emit_blockmovedrect ... ok
test g12_rect_block_move_with_internal_edit_falls_back ... ok
test g12_rect_block_move_emits_single_blockmovedrect ... ok

test result: ok. 3 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.02s

     Running tests\g13_fuzzy_row_move_grid_workbook_tests.rs (target\debug\deps\g13_fuzzy_row_move_grid_workbook_tests-f9bf1aeb4a4b990a.exe)

running 4 tests
test g13_ambiguous_repeated_blocks_do_not_emit_blockmovedrows ... ok
test g13_in_place_edits_do_not_emit_blockmovedrows ... ok
test g13_fuzzy_row_move_can_be_disabled ... ok
test g13_fuzzy_row_move_emits_blockmovedrows_and_celledited ... ok

test result: ok. 4 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.01s

     Running tests\g14_move_combination_tests.rs (target\debug\deps\g14_move_combination_tests-50f9b86d5dc800b7.exe)

running 18 tests
test g14_column_move_plus_cell_edit_no_silent_data_loss ... ok
test g14_pure_column_move_produces_single_op ... ok
test g14_fuzzy_row_move_plus_outside_edit_no_silent_data_loss ... ok
test g14_row_move_plus_cell_edit_no_silent_data_loss ... ok
test g14_move_detection_disabled_falls_back_to_positional ... ok
test g14_grid_changes_no_silent_data_loss ... ok
test g14_rect_move_plus_row_insertion_outside_no_silent_data_loss ... ok
test g14_fuzzy_row_move_produces_move_and_internal_edits ... ok
test g14_rect_move_plus_row_deletion_outside_no_silent_data_loss ... ok
test g14_rect_move_plus_cell_edit_no_silent_data_loss ... FAILED
test g14_row_block_move_plus_row_insertion_outside_no_silent_data_loss ... ok
test g14_three_disjoint_rect_block_moves_detected ... FAILED
test g14_pure_row_move_produces_single_op ... ok
test g14_rect_move_no_additional_changes_produces_single_op ... ok
test g14_row_move_plus_column_move_both_detected ... ok
test g14_two_disjoint_row_block_moves_detected ... ok
test g14_two_disjoint_rect_moves_plus_outside_edits_no_silent_data_loss ... FAILED
test g14_max_move_iterations_limits_detected_moves ... FAILED

failures:

---- g14_rect_move_plus_cell_edit_no_silent_data_loss stdout ----

thread 'g14_rect_move_plus_cell_edit_no_silent_data_loss' (25200) panicked at core\tests\g14_move_combination_tests.rs:129:5:
assertion `left == right` failed: expected single BlockMovedRect for the moved block
  left: 0
 right: 1
note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace

---- g14_three_disjoint_rect_block_moves_detected stdout ----

thread 'g14_three_disjoint_rect_block_moves_detected' (15508) panicked at core\tests\g14_move_combination_tests.rs:543:5:
assertion `left == right` failed: expected exactly three rect block moves to be detected
  left: 0
 right: 3

---- g14_two_disjoint_rect_moves_plus_outside_edits_no_silent_data_loss stdout ----

thread 'g14_two_disjoint_rect_moves_plus_outside_edits_no_silent_data_loss' (31540) panicked at core\tests\g14_move_combination_tests.rs:582:5:
should detect both rect block moves in the scenario

---- g14_max_move_iterations_limits_detected_moves stdout ----

thread 'g14_max_move_iterations_limits_detected_moves' (17144) panicked at core\tests\g14_move_combination_tests.rs:804:5:
with default config, all 5 rect moves should be detected, got 0


failures:
    g14_max_move_iterations_limits_detected_moves
    g14_rect_move_plus_cell_edit_no_silent_data_loss
    g14_three_disjoint_rect_block_moves_detected
    g14_two_disjoint_rect_moves_plus_outside_edits_no_silent_data_loss

test result: FAILED. 14 passed; 4 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.02s

error: test failed, to rerun pass `--test g14_move_combination_tests`
