## Remediation Round 1

- Findings addressed: 1.1 silent data loss masking gap; 1.2 iterative move detection (multi-rect coverage).
- Key changes: added cell-level rect exclusions in RegionMask and masked grid builder; wired masked move detectors with src/dst exclusions on both masks; refined rect fallback to pair column ranges per row group so adjacent moves with outside edits are still detected; kept ambiguous swap rejection intact.
- Files touched: core/src/engine.rs; core/src/region_mask.rs; core/tests/g14_move_combination_tests.rs.
- Complications: initial mask updates re-detected the same rect or skipped later moves; column collapsing hid a second rect when outside edits were present. Resolved by masking rect cells in both grids and matching column ranges per row segment.
- Verification: cargo fmt; cargo clippy; cargo test.

## Remediation Round 2

- Findings addressed: (1) normalize CellValue::Number hashing; (2) normalize database key hashing; (3) end-to-end float noise coverage for diff and row signatures; (4) hash collision note updated to 128-bit; (5) removed deprecated hash_cell_contribution; (6) explicit row-alignment opt-out tests for column insert/delete.
- Files touched: core/src/workbook.rs; core/tests/g1_g2_grid_workbook_tests.rs; core/tests/grid_view_tests.rs; core/src/database_alignment.rs; core/tests/d1_database_mode_tests.rs; core/src/row_alignment.rs; core/src/hashing.rs; core/tests/g14_move_combination_tests.rs.
- Complications: CellValue equality originally used raw f64 equality, so ULP drift and NaN bit-pattern differences surfaced as edits; now uses normalized float comparison alongside hashing. Clippy flagged existing test patterns in g14 suite; resolved with minor control-flow cleanup.
- Verification: cargo fmt; cargo clippy --all-targets -- -D warnings; cargo test.
