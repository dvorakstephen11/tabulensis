- Began implementation pass for 2025-12-03-m4-packageparts. Read excel_diff_meta_programming Section 4, the mini-spec, and decision.yaml to confirm scope and behavioral contract (PackageParts parser, fixtures, tests).
- Captured plan: add datamashup_package module and exports, extend fixtures/generators for one_query and multi_query_with_embedded, implement m4 package parts tests, and run fmt/clippy/test before handoff.
- Added core/src/datamashup_package.rs with PackageXml/SectionDocument/EmbeddedContent/PackageParts structs and parse_package_parts that tolerates leading slashes, maps zip/UTF-8 issues to DataMashupError::FramingInvalid, and best-effort skips malformed embedded content; exported via lib.rs.
- Extended fixtures generation: added MashupOneQueryGenerator and MashupMultiEmbeddedGenerator plus manifest entries (m4_packageparts_one_query, m4_packageparts_multi_embedded). Generators reuse templates/base_query.xlsx and inject Content/{GUID}.package nested zips with Section1.m. Generated fixtures/generated/one_query.xlsx and fixtures/generated/multi_query_with_embedded.xlsx directly via python script to avoid regenerating all manifest scenarios.
- Created core/tests/m4_package_parts_tests.rs covering expected PackageParts contents, embedded content detection, and non-zip rejection. Ran cargo fmt, resolved a clippy collapsible-if warning, and verified cargo clippy then cargo test (all suites passing).

## Remediation Round 1
- Addressed Findings 1-5: added negative coverage for missing/invalid core PackageParts entries; enforced skip-on-failure for malformed embedded content; exercised leading-slash tolerance and EmbeddedContent name canonicalization; added fuzz-style panic guard; clarified and tested UTF-8 BOM handling at the Section1 boundary.
- Files modified: core/src/datamashup_package.rs; core/src/m_section.rs; core/tests/m4_package_parts_tests.rs; core/tests/m_section_splitting_tests.rs; docs/meta/plans/2025-12-03-m4-packageparts/spec.md; docs/rust_docs/excel_diff_specification.md.
- Tests added: missing_config_package_xml_errors, missing_section1_errors, invalid_utf8_in_package_xml_errors, embedded_content_invalid_zip_is_skipped, embedded_content_missing_section1_is_skipped, embedded_content_invalid_utf8_is_skipped, leading_slash_paths_are_accepted, embedded_content_name_is_canonicalized, parse_package_parts_never_panics_on_random_bytes, section_parsing_tolerates_utf8_bom, package_parts_section1_with_bom_parses_via_parse_section_members.
- Complications: None; BOM handling adjusted to strip a single leading codepoint before M parsing while keeping other whitespace intact.
